<%- include('./partials/header.ejs') %>

    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>


    <!-- Humberger Begin -->
    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
        <div class="humberger__menu__logo">
            <a href="#"><img src="/img/logo.png" alt=""></a>
        </div>
        <div class="humberger__menu__cart">
            <ul>
                <li><a href="#"><i class="fa fa-heart"></i> <span>1</span></a></li>
                <li><a href="#"><i class="fa fa-shopping-bag"></i> <span>3</span></a></li>
            </ul>
            <div class="header__top__right__auth">
                <a class="navbar-brand text-dark fs-4 fw-bold" href="#">FRESH<span class="text-danger">org</span></a>
            </div>

        </div>

        <nav class="humberger__menu__nav mobile-menu">
            <ul>
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#">Shop</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
        <div id="mobile-menu-wrap"></div>

    </div>
    <!-- Humberger End -->

    <!-- Header Section Begin -->
    <header class="header">

        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="header__logo">
                        <a class="navbar-brand text-dark fs-4 fw-bold" href="#">FRESH<span
                                class="text-danger">org</span></a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <nav class="header__menu">
                        <ul>
                            <li class="active"><a href="/">Home</a></li>
                            <li><a href="/shop">Shop</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3">
                    <div class="header__cart">

                        <div class="header__top__right__auth">

                            <% if(!id) {%>
                            
                            

							<div class="header__top__right__auth">
                                <a href="/login"><i class="fa fa-user"></i> Login</a>
                            </div>

                            <% } else {%>
                            

                            <ul>
                                <li id="wishlist"><a href="/wishlist"><i class="fa fa-heart"></i> <span><% if(wishlist){ %><%= wishlist.items.length %><% }else{ %>0<% } %></span></a></li>
                                <li><a href="/cart"><i class="fa fa-shopping-bag"></i> <span><% if(cart){ %><%= cart.items.length %><% }else{ %>0<% } %></span></a></li>
                            </ul>

                            <div class="header__top__right__auth">
                                <a href="/profile"><i class="fa fa-user"></i><%= user.username %></a>
                            </div>

							<div class="header__top__right__auth">
                                <a href="/logout" style="box-shadow: none;border: none;" class="btn btn-sm btn-outline-danger">Logout</a>
                            </div>
                            
                            <% } %>
                        </div>

                    </div>
                </div>
            </div>

        </div>
        <div class="humberger__open">
            <i class="fa fa-bars"></i>
        </div>
        </div>
    </header>
    <!-- Header Section End -->

    <div class="container-fluid">
        <div class="row m-0 h-100">
            <div class="col mt-4">
                <div class="sticky-top">
                    <div class="row h-50 align-items-center">
                        <div class="col">
                            <div class="row h-75">
                                <div class="col">
                                    <div class="row justify-content-center">
                                        <div class="col-6 d-flex justify-content-center">
                                            <div style="height: 8rem;width: 8rem;border: .05rem solid rgb(174, 171, 171);"
                                                class=" rounded-circle d-flex align-items-center justify-content-center">
                                                <i class="fa fa-user" style="font-size: 2.5rem;"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row justify-content-center">
                                        <div class="col-6 d-flex flex-column align-items-center">
                                            <div class="row">
                                                <%= user.username %>
                                            </div>
                                            <div style="font-size: .75rem;" class="row">
                                                <%=user.createdAt.toLocaleDateString('en-US', { month: 'long' ,
                                                    day: 'numeric' , year: 'numeric' ,});%></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row justify-content-center mt-4">
                        <div class="col-6 d-flex flex-column">
                            <div style="border: .05rem solid rgb(174, 171, 171);min-height: 2rem">
                                <a href="/profile" class="nav-link text-dark">Profile</a>
                            </div>
                            <div style="border: .05rem solid rgb(174, 171, 171);min-height: 2rem"><a href="/order"
                                    class="nav-link text-dark">Orders</a></div>
                            <div
                                style="border: .05rem solid rgb(174, 171, 171);background-color: #7FAD39;min-height: 2rem">
                                <a href="/address" class="nav-link text-light">Address</a></div>
                            <div style="border: .05rem solid rgb(174, 171, 171);min-height: 2rem">
                                <a href="/wallet" class="nav-link text-dark">Wallet</a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-sm-8 d-flex flex-column">
                
                <div class="d-flex flex-wrap w-100 mt-4">
                    <% if(contact) { %>
                    <div class=" col-sm-6">
                      <div class="card text-center">
                        <div class="card-header bg-light py-4 ">
                            <p class="mb-0">Contact Address</p>
                        </div>
                        <div class="card-body ">
                            <%= contact.phonenumber%>,<br>
                            <%= contact.buildingName %>, <%= contact.street %>, <br>
                            <%= contact.city %>, <%= contact.state %>, <br>
                            <%= contact.country %>, <br>
                            <a href="/address/edit?type=contact&id=<%= contact._id %>"" class="btn btn-sm btn-dark">Edit</a>
                        </div>
                      </div>
                    </div>
                    <% }else { %>
                        <div class=" col-sm-6">
                            <div class="card text-center">
                                <div class="card-header bg-light py-4 ">
                                    <p class="mb-0">Add Contact Address</p>
                                </div>
                                <div class="card-body ">
                                    <h4 class="mb-0">Shipping Address</h4>
                                    <p class="mb-0">Contact</p>
                                    <a href="/address/add?type=contact" class="btn btn-sm btn-dark">Add new
                                        Address</a>
                                </div>
                            </div>
                        </div>
                    <% } %>

                    <% if(main) { %>
                    <div class="col-sm-6">
                      <div class="card text-center">
                        <div class="card-header bg-light py-4 ">
                            <p class="mb-0">Main Address</p>
                        </div>
                        <div class="card-body">
                            <%= contact.phonenumber%>,<br>
                            <%= contact.buildingName %>, <%= contact.street %>, <br>
                            <%= contact.city %>, <%= contact.state %>, <br>
                            <%= contact.country %>, <br>
                            <a href="/address/edit?type=main&id=<%= main._id %>"" class="btn btn-sm btn-dark">Edit</a>
                        </div>
                      </div>
                    </div>
                    <% }else { %>
                        <div class=" col-sm-6">
                            <div class="card text-center">
                                <div class="card-header bg-light py-4 ">
                                    <p class="mb-0">Add Main Address</p>
                                </div>
                                <div class="card-body ">
                                    <h4 class="mb-0">Shipping Address</h4>
                                    <p class="mb-0">Main</p>
                                    <a href="/address/add?type=main" class="btn btn-sm btn-dark">Add new
                                        Address</a>
                                </div>
                            </div>
                        </div>
                    <% } %>
                </div>

                <div class="d-flex flex-wrap w-100 mt-4 mb-4">
                    <% if(secondary) { %>
                        <%for(s of secondary){%>
                            <div class=" col-sm-6 mb-4">
                                <div class="card text-center">
                                    <div class="card-header bg-light py-4 ">
                                        <p class="mb-0">Secondary Address</p>
                                    </div>
                                    <div class="card-body ">
                                        <%= s.phonenumber%>,<br>
                                        <%= s.buildingName %>, <%= s.street %>, <br>
                                        <%= s.city %>, <%= s.state %>, <br>
                                        <%= s.country %>, <br>
                                        <a href="/address/edit?type=secondary&id=<%=s._id%>" class="btn btn-sm btn-dark">Edit</a>
                                        <a onclick="deleteAddress('<%=s._id%>')" class="btn btn-sm btn-danger">Delete</a>
                                    </div>
                                </div>
                            </div>
                        <% } %>
                    <% } %>

                        <div class=" col-sm-6">
                            <div class="card text-center">
                                <div class="card-header bg-light py-4 ">
                                    <p class="mb-0">Add Secondary Address</p>
                                </div>
                                <div class="card-body ">
                                    <h4 class="mb-0">Shipping Address</h4>
                                    <p class="mb-0">Secondary</p>
                                    <a href="/address/add?type=secondary" class="btn btn-sm btn-dark">Add new
                                        Address</a>
                                </div>
                            </div>
                        </div>

                </div>
            </div>
        </div>

    </div>
    </div>
    </div>

    <!-- axios cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.3/axios.min.js"></script>

    <!-- sweet alert cdn -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        function deleteAddress(id) {
          Swal.fire({
            icon: "warning",
            title: "Are you sure?",
            text: "Delete Address?",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "remove",
          }).then((result) => {
            if (result.isConfirmed) {
              axios.delete(`/address/delete?id=${id}`).then((result) => {
                Swal.fire("removed!", "Address has been deleted.", "success").then((response) => {
                  location.reload();
                })
              })
              
            }
          });
        }
      </script>

    <%- include('./partials/footer.ejs') %>